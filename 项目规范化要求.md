# 项目规范化要求

## 名称规范
TencentMeeting-Sim：
1. app_name(英文)：TencentMeeting
2. app_name(中文)：腾讯会议
3. namespace & applicationid：com.example.tencent_meeting_sim

## 整体项目结构
### 1. 根目录结构
从项目根目录看我们的整体项目结构应该如下：
```
Project/
├── .gradle/                 # Gradle 缓存目录（自动生成，已忽略）
├── .idea/                   # Android Studio 配置目录（已忽略）
├── app/                     # 应用模块 ⭐
│   ├── build.gradle.kts    # 应用模块的构建配置
│   ├── proguard-rules.pro  # ProGuard 混淆规则
│   └── src/                # 源代码目录
│       └── main/           # 主源代码
├── build/                   # 构建输出目录（自动生成，已忽略）
├── docs/                    # 项目文档目录 ⭐
├── .gitignore              # Git 忽略文件配置
├── build.gradle.kts        # 项目根构建文件
├── gradle.properties       # Gradle 属性配置
├── settings.gradle.kts     # 项目设置文件
└── README.md               # 项目说明文档（本文件）
```
目录说明:
- `.gradle/`: Gradle 构建缓存目录，由 Gradle 自动生成，不应提交到版本控制
- `app/`: 应用主模块，包含所有源代码、资源和配置文件
- `build/`: 构建输出目录，包含编译后的文件、APK、AAB 等，由构建系统自动生成
- `docs/`: 项目文档目录，包含架构、API、编码规范等文档
- `build.gradle.kts`: 项目根构建文件，配置所有子模块的通用设置
- `settings.gradle.kts`: 项目设置文件，定义包含的模块和仓库配置
- `gradle.properties`: Gradle 属性文件，配置 AndroidX、Kotlin 等全局属性

### 2. Assets 资源文件
位置: `app/src/main/assets`
用途:
- 配置文件（JSON、XML等）
- HTML 文件（用于 WebView）
- 初始数据文件
- 其他静态资源
访问方式:
```python
// 在 Activity 或 Context 中访问
val inputStream = assets.open("config/app_config.json")
val jsonString = inputStream.bufferedReader().use { it.readText() }

// 在 ViewModel 中访问（需要 Context）
class MyViewModel @Inject constructor(
    @ApplicationContext private val context: Context
) {
    fun loadConfig() {
        val inputStream = context.assets.open("config/app_config.json")
        // 处理文件
    }
}
```

目录组织建议:
```
app/src/main/assets/
├── config/          # 配置文件
├── html/           # HTML 文件
└── data/           # 数据文件
```

### 3. 关于 strings 的使用
1. 注意**数据无关的文本资源才放到这里**
2. 存放在 `values` & `values-zh` 目录中
    ```
    /
    ├─ values/
    │  ├─ strings.xml
    │  └─ themes.xml
    └─ values-zh/
       └─ strings.xml
    ```
3. values 下 string.xml 和 values-zh 下 string.xml 支持
    ```xml
    <?xml version="1.0" encoding="utf-8"?>
    <resources>
    <!-- App Name -->
    <string name="app_name">MVP</string>

    <!-- Common Buttons -->
    <string name="confirm">Confirm</string>
    <string name="cancel">Cancel</string>
    <string name="ok">OK</string>
    <string name="retry">Retry</string>
    <string name="loading">Loading...</string>
    <string name="error">Error</string>

    <!-- User Module -->
    <string name="user_list">User List</string>
    <string name="user_name">Name</string>
    <string name="user_email">Email</string>
    <string name="load_users_failed">Failed to load users</string>

    <!-- Product Module -->
    <string name="product_list">Product List</string>
    <string name="product_name">Product Name</string>
    <string name="product_price">Price</string>
    <string name="product_description">Description</string>
    <string name="load_products_failed">Failed to load products</string>

    <!-- Common Messages -->
    <string name="empty_state">No data available</string>
    <string name="network_error">Network error, please check your connection</string>
    <string name="unknown_error">An unknown error occurred</string>

    <!-- Price Format -->
    <string name="price_format">¥%1$.2f</string>
    </resources>
    ```
    ```xml
    <?xml version="1.0" encoding="utf-8"?>
    <resources>
    <!-- App Name -->
    <string name="app_name">MVP</string>

    <!-- Common Buttons -->
    <string name="confirm">确认</string>
    <string name="cancel">取消</string>
    <string name="ok">确定</string>
    <string name="retry">重试</string>
    <string name="loading">加载中...</string>
    <string name="error">错误</string>

    <!-- User Module -->
    <string name="user_list">用户列表</string>
    <string name="user_name">姓名</string>
    <string name="user_email">邮箱</string>
    <string name="load_users_failed">加载用户失败</string>

    <!-- Product Module -->
    <string name="product_list">商品列表</string>
    <string name="product_name">商品名称</string>
    <string name="product_price">价格</string>
    <string name="product_description">描述</string>
    <string name="load_products_failed">加载商品失败</string>

    <!-- Common Messages -->
    <string name="empty_state">暂无数据</string>
    <string name="network_error">网络错误，请检查您的网络连接</string>
    <string name="unknown_error">发生未知错误</string>

    <!-- Price Format -->
    <string name="price_format">¥%1$.2f</string>
    </resources>
    ```
4. 代码中使用 R 中的资源
    ```python
    // 根据状态显示UI
    when (val state = viewState.value) {
        is UserViewState.Loading -> {
            LoadingIndicator() // 使用公共组件
        }
        is UserViewState.Success -> {
            UserListView(users = state.users)
        }
        is UserViewState.Error -> {
            ErrorView( // 使用公共组件
                message = state.message.ifEmpty { stringResource(R.string.load_users_failed) },
                onRetry = { presenter.loadUsers() }
            )
        }
    }
    ```

## Android MVP Architecture with Jetpack Compose

这是一个标准的Android MVP架构项目，使用Jetpack Compose构建UI。
### 1. 项目结构
```
app/src/main/
├── assets/                               # 文件流资源（JSON、HTML等）
├── java/com/appsim/{application_packagename}/
│   ├── data/                             # 数据层
│   │   ├── model/                       # 数据模型
│   │   │   ├── User.kt
│   │   │   └── Product.kt
│   │   └── repository/                 # 数据仓库
│   │       ├── UserRepository.kt
│   │       └── ProductRepository.kt
│   ├── presentation/                    # 表现层（MVP）
│   │   ├── user/                        # 用户模块
│   │   │   ├── UserContract.kt
│   │   │   ├── UserPresenter.kt
│   │   │   ├── UserScreen.kt
│   │   │   └── components/             # 业务组件目录
│   │   │       ├── UserItem.kt
│   │   │       └── UserListView.kt
│   │   └── product/                    # 商品模块
│   │       ├── ProductContract.kt
│   │       ├── ProductPresenter.kt
│   │       └── ProductScreen.kt
│   ├── navigation/                      # 导航
│   │   ├── NavGraph.kt                  # 导航图配置
│   │   └── NavigationUtils.kt          # 导航工具类
│   ├── ui/                              # UI层
│   │   ├── components/                  # 公共UI组件
│   │   │   ├── LoadingIndicator.kt
│   │   │   ├── ErrorView.kt
│   │   │   ├── EmptyView.kt
│   │   │   ├── CustomButton.kt
│   │   │   ├── CustomCard.kt
│   │   │   └── Spacer.kt
│   │   └── theme/                       # UI主题
│   ├── common/                           # 通用模块
│   │   ├── utils/                       # 工具类
│   │   ├── constants/                   # 常量
│   │   └── extension/                   # Kotlin扩展函数
│   ├── network/                        # 网络层
│   └── MainActivity.kt                 # 应用入口
└── res/                                 # 资源文件
    ├── drawable/                        # 图片资源
    ├── raw/                             # 原始资源（音频、视频等）
    ├── font/                            # 字体资源
    ├── mipmap/                          # 应用图标
    ├── values/                          # 值资源（字符串、颜色等）
    └── xml/                             # XML配置
```
### 2. 架构说明
#### 2.1 MVP架构层次
- Model: 数据层，包括数据模型（`data/model`）和数据仓库（`data/repository`）
- View: UI层，使用Jetpack Compose实现（`presentation/user/UserScreen.kt`）
- Presenter: 业务逻辑层，连接Model和View（`presentation/user/UserPresenter.kt`）

#### 2.2 关键类型定义
1. Contract: 定义View和Presenter之间的接口契约（如 `UserContract`、`ProductContract`）
2. Presenter: 处理业务逻辑，管理数据加载和状态（如 `UserPresenter`、`ProductPresenter`）
3. Screen: Compose UI组件，实现Contract.View接口（如 `UserScreen`、`ProductScreen`）
4. Repository: 数据仓库，负责数据获取（如 `UserRepository`、`ProductRepository`）

#### 2.3 Components组织原则
1. 可复用组件 (`ui/components/`)
- 放置可在多个Screen中复用的通用UI组件
- 例如：`LoadingIndicator`、`ErrorViewr`等
- 组件应该是无状态的，通过参数接收数据
2. 特定功能组件 (`presentation/[功能]/components/`)
- 如果组件只在一个Screen中使用，且该Screen功能复杂，可以创建`components/子目录`
- 例如：`UserScreen`有用户Item 和 用户列表等组件，创建了`presentation/user/components/目录`
- 包含的组件：`UserItem`、`UserListView`等
3. 简单Screen（不包含components）
- 如果Screen功能简单，UI逻辑不复杂，可以直接在Screen文件中实现
- 例如：ProductScreen功能简单，直接在ProductScreen.kt中实现所有UI
- 不需要创建components/子目录
4. 组件命名规范
- 使用描述性的名称，如UserCard、LoadingIndicator
- 特定功能组件使用功能前缀，如HomeTopBar、HomeSearchBar
- 遵循PascalCase命名
5. 何时创建components子目录？
- ✅ Screen功能复杂，包含多个独立的UI模块
- ✅ 需要将Screen拆分成多个小组件以提高可读性
- ✅ 组件可能在未来被复用或扩展

### 3. 扩展方式
#### 3.1 添加新功能
1. 在data/model中创建数据模型
2. 在data/repository中创建数据仓库
3. 在presentation中创建新的功能包：
  - XxxContract.kt: 定义契约接口
  - XxxPresenter.kt: 实现Presenter
  - XxxScreen.kt: 实现Compose View
  - components/（可选）: 业务组件目录，或直接放在模块目录下
参考示例：
- user 模块：使用 components/ 子目录组织业务组件
- product 模块：业务组件直接放在模块目录下
### 3.2 使用公共组件
项目提供了可复用的UI组件，位于 `ui/components/` 目录：
```python
import com.appsim.mvp.ui.components.LoadingIndicator
import com.appsim.mvp.ui.components.ErrorView
import com.appsim.mvp.ui.components.CustomCard

@Composable
fun MyScreen() {
    when (state) {
        is Loading -> LoadingIndicator()
        is Error -> ErrorView(
            message = state.message,
            onRetry = { retry() }
        )
        is Success -> {
            CustomCard {
                Text("内容")
            }
        }
    }
}
```
### 3.3 组件使用说明
1. 公共组件（`ui/components/`）：
- 可在任何模块中使用
- 与业务逻辑无关
- 示例：LoadingIndicator、ErrorView、CustomCard
2. 业务组件（`presentation/xxx/components/` 或 `presentation/xxx/`）：
- 只在特定模块中使用
- 包含业务逻辑和业务数据
- 示例：UserItem、ProductItem
3. 更多组件说明请查看：
- [公共组件说明](app/src/main/java/com/appsim/mvp/ui/components/README.md)
- [业务组件组织说明](docs/business-components.md)
- [组件组织方式对比](docs/component-organization-comparison.md)
4. 注意事项
- 可复用组件应该放在 ui/components/ 目录下
- Assets 文件放在 app/src/main/assets/ 目录下
- 可以通过 AssetManager 访问 assets 中的文件
- 对于需要返回上一级的页面，页面跳转时使用navController.navigate("xxx")，不要加额外参数
5. 常见错误
- 把所有 Composable 都放在一个 Screen 文件里（超过 300 行就该拆分）
- 在 Composable 里直接调用 Repository
- 把业务组件放到 ui/components/（那里只放通用组件，能复用的再放）